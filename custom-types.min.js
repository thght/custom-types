(function(){var t,e,n={}.hasOwnProperty,r=[].indexOf;e=require("types.js"),t=["SET","GET","LOCK","UNLOCK","IS_LOCKED","LOCKED","_KEYS","_HANDLERS","ON","OFF"],e.create=function(i,o){var s,h,c;o=e.isString(i)?e.forceObject(o):e.forceObject(i),i=e.forceString(i),s=function(){class t{static getModel(){var e,r,i,o;e={},i=t._model;for(r in i)n.call(i,r)&&(o=i[r],e[r]=o);return e}static _handleEvent(t,...e){var n,r,i,o,s;if(this._HANDLERS.hasOwnProperty(t)){for(s=[],r=0,i=(o=this._HANDLERS[t]).length;r<i;r++)n=o[r],s.push(n.apply(null,e));return s}}static has(e){return t._model.hasOwnProperty(e)}static _has(e){return!!t.has(e)||(t.showError(e+" doesn't exist in the model!"),t._handleEvent.call(this,t.UNKNOWN_KEY,e),!1)}static setLogMethod(n){return t._settings.logMethod=e.forceFunction(n)}static showError(e){return t._settings.logMethod(e)}static _isValidType(n,r){return e.typeof(r)===t._types[n]||(t._handleEvent.call(this,t.TYPE_ERROR,n,r),t.showError(" cannot apply the "+e.typeof(r)+" type value: "+r+' to field "'+n+'", the value should be of type '+t._types[n]))}static _addGetSet(t){if(!this[t])return Object.defineProperty(this,t,{set:e=>this.SET(t,e),get:()=>this._KEYS[t]})}constructor(n){var r,i,o;n=e.forceObject(n),this._KEYS={},this.LOCKED=[],this._HANDLERS={},this._HANDLERS[t.UNKNOWN_KEY]=[],this._HANDLERS[t.TYPE_ERROR]=[],this._HANDLERS[t.LOCKED]=[],this._HANDLERS[t.SET]=[],i=e.forceObject(t._model);for(r in i)o=i[r],t._addGetSet.call(this,r,o),n.hasOwnProperty(r)?this.SET(r,n[r]):this._KEYS[r]=o;e.forceFunction(Object.freeze)(this)}IS_LOCKED(t){return!!~this.LOCKED.indexOf(t)}LOCK(...n){var r,i,o,s,h;for(h=[],r=0,o=(s=e.intoArray(n)).length;r<o;r++)i=s[r],t._has.call(this,i)?h.push(this.LOCKED.push(i)):h.push(void 0);return h}UNLOCK(...n){var r,i,o,s,h,c;for(c=[],r=0,s=(h=e.intoArray(n)).length;r<s;r++)o=h[r],t._has.call(this,o)?(i=this.LOCKED.indexOf(o),c.push(this.LOCKED.splice(i,1))):c.push(void 0);return c}GET(...n){var r,i,o,s,h;for(s={},n.length<1&&(n=Object.keys(this._KEYS)),r=0,o=(h=e.intoArray(n)).length;r<o;r++)i=h[r],t._has.call(this,i)&&(s[i]=this._KEYS[i]);return s}SET(r,i){var o,s,h,c;if(c=((e,n)=>{if(!t._has.call(this,e))return t.showError('cannot set value for key: "'+e+"\", it doesn't exist in the model!");if(this.IS_LOCKED(e))return t.showError('cannot set field "'+e+'" to: "'+n+'", "'+e+'" is locked!'),t._handleEvent.call(this,t.LOCKED,e);if(t._isValidType.call(this,e,n))return this._KEYS[e]=n,t._handleEvent.call(this,t.SET,e,n)}),e.isObject(r)){s=e.forceObject(r),h=[];for(o in s)n.call(s,o)&&(i=s[o],h.push(c(o,i)));return h}if(e.isString(r))return c(r,i)}ON(t,n){if(this._HANDLERS.hasOwnProperty(t)&&e.isFunction(n))return this._HANDLERS[t].push(n)}OFF(t,n){var r;if(this._HANDLERS.hasOwnProperty(t)){if(!e.isFunction(n))return this._HANDLERS[t]=[];if((r=this._HANDLERS[t].indexOf(n))>-1)return this._HANDLERS[t].splice(r,1)}}}return t.UNKNOWN_KEY="unknown-key",t.TYPE_ERROR="type-error",t.LOCKED="locked",t.SET="set",t.id=i,t._types={},t._model={},t._settings={logMethod:function(t){return console.log(i+": error! - "+e.forceString(t))}},t}();for(h in o)n.call(o,h)&&(c=o[h],r.call(t,h)>=0?s.showError('"'+h+'" is a reserved word and cannot be used in a model'):(s._types[h]=e.typeof(c),s._model[h]=c));return e.forceFunction(Object.freeze)(s),s},module.exports=e}).call(this);